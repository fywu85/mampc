function [Y,Xf,Af] = nnmove_04(X,~,~)
%NNMOVE_04 neural network simulation function.
%
% Auto-generated by MATLAB, 29-Jun-2022 03:24:44.
% 
% [Y] = nnmove_04(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 12xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 4xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.845918270200932;-1.30490266637008;-0.644822293238671;-1.8459585658227;-0.528101821673327;-0.399260196702291;-0.473219582538623;-1.85436538017275;-0.497898475723062;-1.90921670427207;-0.645412690014965;-0.295907880808792];
x1_step1.gain = [1.30953763543212;0.659138484640931;1.41210726415125;0.630893986156085;2.12022072576962;2.96896242792547;2.02865297091875;0.504314799844091;2.03919466078945;0.52529696099827;1.41721499548231;3.66792002962172];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.7294864771401377013;-2.3886525387429271561;0.45502992134406605729;-0.030402738583056670985;-0.56890243637711901403;0.73367772345952242397;0.25997869676829665764;0.22380058989251649937;-0.050372312416200958063;-0.15389975022256449644;1.5353694884448103597;-0.10733323902666221106;-0.50541963358273578333;-0.25211371444943792008;-0.38536126458978786635;0.57870193968027439091;0.56704334104557496676;1.8123248342887068318;3.6114499836558038304;2.9851027137879628803];
IW1_1 = [0.28631028459801655117 0.51125492316567244799 -0.31565109625607473687 -0.49315163485784785369 -0.30408004875148619828 -0.44564382940381519482 0.51320770230974444015 0.53057867201802044743 0.76928624458374306183 0.43745919679659017731 0.41044399484248966781 0.23152117044059353224;-0.66674633130834248806 -0.69744824522083870288 -0.10154850184895197751 0.0037513152305536073133 -0.15505115065926938778 -0.078959674555168821164 0.19268911135340147101 -0.075130976068052968131 -1.2501966122949874638 -0.74137169453786377904 0.1007237376985947036 0.083401360797390911017;-0.20541789906242954866 0.63503811990530378839 -0.20890454842159686399 -0.13172232287381349658 0.7966450432727195663 0.466705080742396472 0.13038161742102929996 -0.36216788365637891944 0.12888221080183240308 0.02680851990354807951 0.071841651440306492082 -0.00049808885475539194619;0.052109288318324314959 0.066716127176510750529 -0.026809899549752939235 -0.060353000683861762754 0.23200909259762517167 0.18198194822551069794 0.083901210691031777311 0.089610399891270023365 0.10300788212738795635 0.081069603842179829845 -0.010898006579319524656 -0.0098142404080719287951;0.76157561942783502662 0.55454904759629852773 -0.15633231615229420397 -0.23698004614576520521 -0.17142666707031439799 0.13877729155563250929 0.4273588935859267135 0.12515170246981371927 0.93967397090441906471 0.27839370436676025289 -0.37897198968544915099 -0.19457480325589462944;0.23046766196313492325 0.4169314852341233224 0.13788039239164645577 0.28157704709383546415 -0.11613465872131306655 -0.090667723110098880079 -0.3953476902130673154 -0.40522456403212331333 0.61304579632268496603 0.60835505248834209624 -0.1152739592470878871 -0.069346297770044251774;0.27406042846340061825 0.54838891040196902082 -0.28611357232355788538 -0.31445766694917326456 0.51937949927574655895 0.37137771397081387192 0.54929789793163152911 0.11212590768266939012 0.2720074495643270418 -0.3091769539453411153 0.21690849701892217505 0.063483627819661839209;0.073828722456837317378 0.36132587603753746341 0.056919929950626259318 -0.21946041312454286909 0.10607074939817634496 0.12194008743929071747 -0.32926138921404946025 0.30754642514275387644 0.49582853850257407879 0.75213199465795921306 -0.15491453687651784987 0.017528159702303241357;0.0082113239587366763927 0.0050099837077015327638 0.047699705767181063698 0.09620113174233727027 -0.089131992003012527892 -0.061794773949092593468 -0.12997669795392510772 -0.139072061124215135 0.0078600909682607755097 0.0023149221456676889221 0.21480692129322229156 0.1292035391985472681;0.05548834206861434637 0.12812993801748459588 -0.004708126279366831729 -0.0039814807966274574913 0.11221657269235847665 0.084653365220690057757 0.0091600627787010169278 0.0055826823890116616944 0.18371770335277451403 0.20231074553388725401 -0.010346396278206897515 -0.0030368691488758280984;0.93929914379304335625 0.717537559580264106 -0.48193684663122665635 -0.30265325387074737407 -0.43082633346364740401 -0.11200941100019949637 0.64481183066669556236 -0.015336495877666701804 0.60060805353891388858 0.13514593545398484453 0.23488012602143706897 0.083458569965690468373;-0.15598366981495323524 -0.2251532332194801922 0.048513585780832396699 0.10768857432500573978 -0.057557448088163681854 -0.031982212603803530926 -0.13076150888805179728 -0.15333853879997569325 -0.33835246360074394678 -0.28591677180145685933 -0.1287528453040004961 -0.065576379609068979892;0.00019835533434342747668 -0.0069215528882704694183 0.17102356930955850411 0.3504059663711576178 -0.17768412367120156592 -0.14047101869763684023 -0.49234964666762059959 -0.5041154000598508933 -0.0070991841705747302585 -0.015376323285135306759 -0.036647993552803827255 -0.023366974688783386654;0.036665831487452130166 0.016659673551061262436 0.23112418408847323903 0.26685235986997724034 -0.36828369447141240389 -0.26318850037968311018 -0.5410820367141223608 -0.17174531783095814408 0.30432108146756708944 0.45779117534416169377 -0.35371162272748624122 -0.13964191086877209003;-0.05060513899810784727 -0.085497536024496556539 -0.092251525171302597994 -0.18835124632129515709 -0.042784237416417812694 -0.031227222605607275058 0.26952619274200101396 0.2748101728539942834 -0.12525704562519188179 -0.11890910655252927286 -0.0057497637430202258244 -0.0018542560483571905207;-0.12957047409348784739 -0.24112453786227180941 0.038807408900715295585 0.08021097271039216714 -0.087032009773013507825 -0.067417137012790395723 -0.11065825444713782433 -0.11485471485858211871 -0.34998503020667326435 -0.3520917540932084755 0.16560567261969069697 0.099407850115357077048;0.021415381546114165001 0.040698865070956366519 -0.13912281231125944725 -0.2849805892432699661 0.16520682002426187451 0.1313132608435182147 0.40237816262821096691 0.41121026420366968424 0.05848766150257760088 0.061116614427647555918 -0.080078877470312836984 -0.046828337727423820225;0.39402290776937631822 0.28298898605260980332 0.0056675466347636590386 -0.21205524378872492308 0.36822057264497826123 0.18170482813099941843 0.12809422820009741528 0.41591023738723137404 0.42017246099276639448 -0.092325554889048450091 -0.3893715514300906122 -0.42057909756967498671;0.045995648609379359562 -0.31957722256721099452 0.32781648494894577439 0.61162325633416203541 -0.18459291320729731556 -0.04449070799564749934 -0.5591229573046737622 -0.68974637987998466127 -0.32820602033055024105 -0.59476682125523350209 0.099873214572445967452 0.082303071034081368151;0.012012369578356997882 -0.019287008917195761631 -0.01228433497850772195 -0.017699470838201093736 0.41986017106583728431 0.3359252168299675656 0.022454246621776207532 0.014032215606467630248 -0.034641918685916657517 -0.060285660222512506279 0.064943258598479103316 0.039257924357104637125];

% Layer 2
b2 = [-1.6903336686789194321;1.7091831974301872066;-1.0915294429918822594;0.20726697413305963935;0.25147643935179958552;-0.41852766425100718095;0.72900367486866091138;-0.66008718044196024177;0.70541008457274578802;0.72538290069179545139];
LW2_1 = [0.64004772057117287343 -0.80091170521734089682 0.12232198025635931948 -0.34677630569841449981 0.19145547054932993136 -0.25804972752305743722 -0.27712771641405498091 -0.13135576837199233746 0.54891319251217784991 0.36483227944621238192 -0.56465877996163804653 0.21134551335809967365 -0.43020964981679787886 -0.14862775847364495529 -0.20183816190066644625 -0.69348799644369729656 0.094851837051293214076 0.14098004794741370027 -0.018242812974004860016 -0.77370744046743145095;-0.8692157635380814984 0.11202739795448252158 0.18743984781248093641 -0.3207448944817835601 -0.62833207439272520389 -0.73389012082387317104 -0.026056600991810775075 0.25330224999925621265 -0.44765456894565303081 -0.81537489185638867273 0.046514207640894332518 0.41528785037155968585 0.058477611392270652246 -0.27251759665868097171 -0.39261354512773272152 0.46206442026353117258 0.22539446869394380579 0.12468764376673022176 0.6568421034915600254 0.77499436194299942127;0.090590837337740412472 -0.81533012785347547258 0.099466386633781475601 0.65106214816661789335 -0.053546679328619249671 -0.15866203384347971062 -0.090945660558224339365 -0.079330410953494481796 0.15830071480413648866 -1.1811098697213413544 0.036147562813673421445 -0.051909879560179381097 0.61422003005994241231 0.12117454542098214654 0.25624126812092584693 0.23688844713512946516 0.28834633125841424572 -0.22288933848723127551 0.20889103459386945683 -0.43374539513127391421;-0.0059050465908474175994 0.10003528568664635245 -0.019994043211310288249 -0.048133942876725142879 0.0042502740327064756146 -0.15610306949680285982 0.016557736073143362876 0.018533348893986861805 0.28625313704285970662 0.44106068222722755179 -0.0059516511600046454605 -0.11259736272385256761 -0.40161842687254428741 -0.02912996739979246269 0.28160269480685656829 0.31807501393899872966 -0.56896280236916485507 0.039187967203951998285 -0.62982058763053827555 0.50691092490062228393;-0.084748228310539477914 0.15619365615103614209 0.039212973935616492194 -0.27231130184498697488 0.01506562648786223188 -0.074985526952131051348 -0.020724374410797542084 -0.042993892318489990156 -0.42483391466182651719 -0.54051157460862409021 0.014956436170320252729 0.1395723674793509228 -0.34551726982116010012 0.087559790100503395727 0.080127241883823113744 0.3902530335609216694 -0.037385555882890601775 -0.043618841487226035769 0.10170989105641714545 -0.02738018917837456781;0.016070990155748286071 0.45880765724287381202 -0.041501895997217028156 -0.49658692833411932632 0.0096837207994924876658 -0.012166640814508033336 0.041827829050897581686 0.028199495125046231819 -0.36545624893141109846 -0.50472055723245623504 -0.023528512591512479313 0.14613940454582624584 -0.26528949829767456414 -0.037964912048854229654 -0.040274864445062411034 0.46946385700978426891 -0.04197570469521048897 0.062787707067124151616 -0.36280910666119170482 -0.39194876090335384333;-0.022567185228562963717 0.10035905997831931491 0.024651233096816344698 -0.20322478584959161041 0.0019923192476595905261 0.15202820167811362251 -0.012795306619486091979 -0.025735021506084313631 0.17558896051647002179 -0.07525152756054662162 0.012302283743078675643 -0.097637252441944349934 -0.059118669280281269107 0.056957994811273372771 0.22110963921606646698 -0.15686117949101213709 0.16504347767506002964 -0.042211376283319529401 0.67687538344335018703 -1.0188291789898658024;-0.071782940418958093853 0.37173585108748580241 0.12094406385137276838 -0.042304660156242485103 0.021957385980390688174 -0.45849161825169310047 -0.079344161043640906716 -0.11948800002317647162 -0.079179181219698802074 -0.85990942868078568129 0.05467337877389261136 0.15949904583203725061 -0.32128350030332009091 0.24106554900360357974 0.2348034979425576152 0.21725404689587290985 -0.18049491684134275071 -0.1896775126557967428 0.10847494578628798234 -0.087491810628390079274;0.045234872409894391621 -0.79009966016855892601 -0.067560251788283690044 -0.2501418375943477157 -0.015437720855557912972 -0.092564141149627465754 0.023407972185521670055 0.081268463443712440908 0.048618774305928348645 0.16363887091263029649 -0.02451761497424223904 -0.19480482663516465736 0.6292372106563697276 -0.1934651000553927469 0.75889735640367583791 -0.12422050137718079754 -0.073998071960305417116 0.12885670792888581637 -1.0551973396823195461 -0.35834128968325867914;-0.017970197693895309521 -0.0061213629595839738964 -0.008737591453528778182 -0.23222854951511562316 0.0049803004994176929693 0.091505392401192375829 0.0059913972259277477328 0.0084200084436333814258 0.10696285266216457033 0.04058552020260530746 -0.0019528334706901677876 0.048031455546434856374 0.074149964314907404472 -0.017202770989527604861 -0.50135520088608365175 0.16246467377272968968 -0.17683618238450532489 0.022708464558917656334 -0.26727399705908200245 -0.5198250892088360775];

% Layer 3
b3 = [1.7813481667280053333;0.73577253905217088192;0.7809220063803254952;0.33889018687224148341;0.099570261592586695176;0.40542828034658950909;-0.22978468111746822022;0.62454759810452387114;-0.97358522754377818664;-1.6392282031019145272];
LW3_2 = [-0.12742058216708374019 -0.039054715349119806245 0.37006657677508203452 0.58484729588713457726 -0.17080128534062888335 1.2112387025008879426 1.2387837385324329542 0.4844229364968427598 -0.63253129038215338831 0.12826573139874544727;-0.17900345997327260505 -0.21220142406930148082 -0.64960952029301488597 1.7152115531400540238 0.30029051174806137281 -0.83556880844220493554 -0.03133125203383557017 0.26991728307561119182 0.35896507564375879085 0.69717438777098217351;-0.24488738720364428003 0.32743848401196162801 -0.11340309643610259338 -1.2102006435028327402 0.72988000187448032197 -0.33315930339099075752 -1.6385263411465575967 0.2225462442705390953 -0.14706258603100794136 0.79909624755362496096;-1.0823154403149457536 -0.034644884287143067059 -0.36211348302856871673 -0.33624914621681473159 -0.036114978769850904217 1.1747251408162009412 0.31627144610265806035 0.82329874395379598617 -0.227232000487748248 -0.086539389009298320343;0.24413020961442868928 -0.077508724501656564576 0.51360908868644794545 0.092663602136865030889 -0.26807780009406906307 0.24715804024166712627 -0.10065144150191994432 0.19360158421271989049 0.031165812611825806366 1.2564025003379728496;0.35371695964083704755 -0.65112620937401799459 -0.3048423135457323796 0.32759509593715230302 -0.64777216009564597687 0.70125935444083498105 1.3968262947974554589 0.80300872753240881696 -0.59692304059557765861 0.76558858673398766381;-0.065433023800716291762 0.33775825060180619808 0.69172106794149212927 -0.88383355874380342687 -0.59088216090321710183 -0.11102967299056389072 1.0355551810224841169 -0.085423973999901967047 0.26307828647853376269 -0.16181970425264430302;1.0319719666850855067 -1.2268975510501589632 -0.65226932771409806833 -0.11794778669880436051 0.039856681188959290629 -1.1412519767271434024 -0.038159020770780406606 -0.66584379820916839154 0.53876405944584893071 0.077556791551048359645;-0.38418059078344146684 -0.11549763622573344657 -0.50677155971008847057 0.090224608637386530252 0.13098579294417322938 0.13887579126193980161 -0.27063959130231074468 -0.2643236567661205183 -0.69236509423484748904 0.89532874847825505427;-0.7130879045236580005 0.4755449151314579681 0.3450928817484547606 -0.1218601750507807141 -0.86022393474487401921 -0.94863296115168638245 0.22786284863517999866 0.78613953739311093205 -0.7442751338864438404 -0.44536428852352283325];

% Layer 4
b4 = [-1.579148248818842637;-1.7610943890815415891;-1.5011943046328715123;1.732307984525762512;1.3793628783644553693;0.60824074573322195469;-0.8515438582016193747;-0.21948358897445394144;0.18437146433379855703;0.24973692221031501548;-0.14612010175663248113;-0.43591962775919251838;0.32020377313198289393;-0.073700029821427925913;0.83592966218930109257;0.86923328655830056633;-1.1469905294366808945;0.99279207046860229458;-1.7754058210887133651;-1.6682679921300880288];
LW4_3 = [-0.0053930441518347050148 -0.014152472338644774691 -0.26991943726623301991 0.9153138342963119678 -1.2859792582673570394 -0.24162914368719740077 -0.74109916998837044311 0.90553100280590559379 -0.70286819648457232734 0.74508666634702458431;1.1620208830130904776 0.53795972511175405018 -1.0690936019459105211 -0.21343781502016789808 -0.19495206264129175122 -0.43625873234780254695 -1.3506734662890707011 -0.44072184185281476632 0.19195700921373187731 0.73427351069442903242;0.33094404538530874937 -1.3673750512366729115 0.62799996069930741349 -0.12772514592637010389 0.17549205374807652635 0.9325188689036641998 -0.74848467848495192634 0.80756430556230518469 -0.43357855514444965106 -0.19981898284311805369;-0.27709712248920859157 1.238977206150052135 0.80105283882050648536 -0.57116635671116500195 -0.63714868960968584766 -0.94119372239647813849 0.82013627145892187276 -0.34709242804396978066 -0.35654446961182634235 -0.039109346984410174597;-0.6340290370170944545 -0.96433464651471201279 0.043138501469692537571 -0.23931122898033568847 -0.78108764434970345825 -0.050804960742771521076 0.90297135357867830407 -0.65554371340482187058 0.85357227814709613067 0.37978888343365935221;-1.0020141281803951472 -1.1286951637471247523 0.2093530014775521475 -0.32922233394096195314 -0.36595176344178476091 -0.64455666294673408245 -0.9318108518070462587 1.2171640982445048884 0.49141843788619071765 -0.47231164611248749319;-0.25551122710154733353 1.0112451361349523715 -0.010128828477645084385 0.60287286363716818816 -0.85836976047544433222 -1.1885658237198093445 0.40130758269310190522 0.34728611915358592599 -0.40188208975174383175 0.61721321655188632338;1.0490194942747472773 0.022755471013053682472 -1.2694098054919653595 0.54283421584781044178 -0.32048559720968705644 0.18554167678852623302 -0.88876741979329365595 1.2950903842075722761 -0.23594224515451839297 -0.52923010708133844116;-0.3609570545654492979 0.39199436055055653094 0.22268044042281021078 -0.35710417868705091049 0.59111389818348358816 -0.45108923785269611217 0.34768939673779314381 -0.7843199176950772511 -0.19692280150095889391 1.113962796415168377;-0.57848293802816586062 0.23876140185417762951 -0.22752653095981700826 -0.59550950162235050112 0.31162524544184350139 0.12361965965684869329 -0.45230940221237908583 0.92836082111738071898 0.79744411617760380118 1.0196818623192411835;0.2795062019087164451 -0.18105618048245025742 0.12276636999670370587 0.43143589986619779175 0.60112347725255732556 0.21336756255193337073 0.38015785931530782227 1.2932810936856333761 -0.32585685383908796764 -0.5115383781878405367;-0.94718963290389890375 -0.21797194693815885591 1.0522156827282227454 1.0644720532073852493 1.2438396590908666894 -0.68236179918516948195 -0.33565894062493245587 -0.16530926991289221495 -0.19717060926558468981 0.34241807201962287666;-0.18562578624256398374 -0.85127459822027651271 0.56669589888534410704 1.0561679834639428055 0.24319135565999419613 0.7057568160887814912 0.34175101504519911355 0.13713450333923199453 -1.033350439955918576 -0.49445610107329757144;-0.22594775137663186682 -0.31340373747590943854 -0.35490730269605119673 0.52634164281060547008 0.96610517556030039987 -1.1043159844825849447 -0.45543199649634463766 0.15676772974288802343 -0.41840736872597339424 -0.91443182441708636965;-0.31393111331210826753 -0.30150317275684079821 -0.20538379139546433794 0.37454020305050939044 1.0183963860012952285 0.4780797535567333223 1.1576587151678050525 1.0331681865663486786 0.51079554635069435164 0.10201441044647444056;0.024666466579908154222 -0.029863022865484357277 -0.96927687666035311498 -1.2838838802014029827 -0.62250731336533238203 0.53868237269839924775 0.76065177661474014936 0.91644503220499118346 -1.1895881493621196512 -0.47513421039921055478;-0.94775244236616595916 -0.43795798998516871636 -0.86710799307030683725 -0.092101848690910176343 -0.51932305843401993517 -1.2284156506491703542 0.67322347578376240396 -0.22898376255434393922 -0.57337983766598488167 -0.020817675722423382295;0.15134764092202285246 0.48112772535763914661 -1.5098774565289911909 -0.020035945652748174406 -0.54649979698527284544 -0.17806718074504887528 0.028648943870967537306 0.12549882135442558262 -0.98865834027222765368 -0.6039820198148495578;-0.85792421638450899746 0.60781108829570074104 -0.79508511778298018857 -0.81822555801860474833 0.2781234787970563449 -0.72823395578772520675 -0.32309273591035991835 -0.17091946013961012429 1.1592386734546369365 0.34044697080848729254;-0.34057336659688419722 -0.86699396529100680731 1.888855913746577242 -0.014507946609691360629 -0.28698954238311880083 -0.24736477281685956275 -0.11263951224299798004 -0.55765476357853416278 0.1066763738886888635 -0.37284852433014370465];

% Layer 5
b5 = [-0.17682808351014753234;0.048852034582403690288;-0.26032181111022756337;-0.86531267169555570185];
LW5_4 = [-0.3754880076748772777 -0.49054031183779850389 0.57581368822466971746 0.8190524707254052128 -0.059959212818195162242 -0.52705120281413386785 -0.94404174213514080449 0.52491402835566247642 -0.33247075163817446652 -0.32744872151401216431 0.65285575273566442966 -0.95873547077900778124 0.052970192812541283534 -0.84048365100806321504 1.0345926967341128044 -0.13732897957411890899 -0.14181917204440203095 0.85352890446243578904 0.62795502628738764095 -1.4406717093745882163;-1.3964110869143155913 -0.64009393078851528625 0.067448623617777675454 -0.016910691953938163101 0.34222323850704450265 0.063261989102424850961 0.2488120901006636021 0.064445048418361558507 -0.047821561537800469366 -0.42295676587287750481 0.61382501042524229007 0.78952189262094207844 0.26867541057257970927 0.39381139082681632102 0.80886542278194917266 -0.27869617157954013065 -0.9265776419575920686 -1.3200513904441144586 1.2516700144706423004 0.10010972573020908427;-1.1623459153341406669 0.70266425659619613509 -0.30386081986879892591 -0.25427929601007381866 -0.84044870621547118628 -0.059611185902350649624 -0.50430412237171462486 -0.42523481584428884927 -0.064959164744711708761 -0.38887869062863039682 -0.20089566369505659771 0.19556384810757104775 0.21779341762352980028 0.57981311091177145656 -0.85233135964744444202 -0.12937942587709835851 0.023283658579555707724 0.50286817490342827774 0.36305991136447651746 -0.69244048622574005947;1.2020424346435840679 -0.83419623660261466025 0.10049794107171833302 -0.059808634351126294115 0.20057873935482511962 -0.38677888247631742047 0.53459293031117460782 0.2284326201760590036 -0.9516283445006379349 -1.273431522096690971 0.57544258612144305598 -0.14905309462784130381 1.070889418667681614 -0.54976986258201898661 0.14076393215990898322 -0.25715448861764778066 0.9920926701334400466 1.0937841233413079234 -0.75887404875653274861 -0.32793328509299851659];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [0.0397039958504373;0.0393255178550111;0.0400372589880812;0.0416989841712608];
y1_step1.xoffset = [143.937094917083;145.966854132823;144.540423916782;141.245908245125];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = tansig_apply(repmat(b4,1,Q) + LW4_3*a3);
    
    % Layer 5
    a5 = repmat(b5,1,Q) + LW5_4*a4;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a5,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(5,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
