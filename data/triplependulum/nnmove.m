function [Y,Xf,Af] = nnmove(X,~,~)
%NNMOVE neural network simulation function.
%
% Auto-generated by MATLAB, 24-Mar-2021 21:46:43.
% 
% [Y] = nnmove(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 3xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.60797735046574;-6.54440782360018;-1.2424576307575;-22.7877223274111;-1.12578776056223;-21.9048948898131];
x1_step1.gain = [1.76962384543089;0.149743119375553;0.801317220475453;0.047542156544781;0.901118960480728;0.045206047538392];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.3951547539659863162;-2.1432907870880191226;-1.747074865899147067;-1.8548998613406635361;1.4701597091864155864;-1.1469806837981588732;0.66146879960111348851;-0.29706623276879751128;0.093122456777889883739;0.22391653645191195166;0.11931826896110886427;0.12615287070558822702;0.76799693753635733806;1.1000136343289292906;0.92043612949063235984;-1.3189028756357763505;-1.5821198235073448135;-1.9464849383799465166;-2.0479652007380346745;-2.6347610512044785658];
IW1_1 = [-0.46822306248868100775 -1.2669595129579582782 -0.17638403732335020124 1.1882352083131149101 -1.0718233787894229092 0.59664051381499783044;0.96438482034922701214 -0.75847252746641968812 -1.3117692319411677904 0.43859619759108947612 -1.1858051892154644058 -0.22904497169751658614;0.20784966035018398456 -1.1024331383558949593 -0.51149786357055071484 -1.5405145072622346003 1.1805869729893485598 -0.063315210727816498282;1.1281136690512989507 -0.58330029014935425025 -0.5905224260969815786 0.60691347189902089543 -1.0972237393999868527 0.98958788538725017681;-0.65125525773936632223 1.3435706485032481439 0.97010191390156008673 0.18981350108422667677 -0.87628372031698176237 0.80239848842096950232;1.0372932307140201313 1.1660059698393068217 -0.27924288608800562628 0.35166866204766350501 -1.4587704807878687507 -0.04478193689239717834;-1.0153145706186954556 -1.2153057503904216574 0.30536719631188868895 0.13505614305507870898 0.74578566253137990039 -1.0178703279076373178;0.45535842577944068976 0.78871946184320029793 -0.67397353708088858504 -1.6752566972314317795 -0.12020075293606781452 -1.0294309518153050842;-0.71508062706382702345 0.73252803516751341384 0.90340140537369018059 0.3471110320064458854 -1.1204637911670123351 -0.34527221729530949146;0.14350416594223913691 0.59148089349388144331 -0.68252020259226742205 -0.32727951265419802374 -0.99461839699456777719 0.65043017247469026021;-0.10480662015061929793 -0.8737324284698253507 0.45763735026581514598 -0.46839115492781907557 -1.1035068159131333765 1.6151508251628778901;0.62213262549527803547 1.456182844594101633 0.055177537988957831017 -1.4195413098075890801 -0.10807060462399327438 -0.7068230135569961714;0.97339543324992949813 0.44046432108692651353 0.64854097911213459682 -0.44443346889727441962 0.48993121961593433245 -1.4992920158394373864;0.31825155168057805977 -1.3963864496707871776 1.0667093317542533093 -1.2898156943138825437 0.66662297391257863133 -0.46943770048183519616;0.11719333678185003822 -0.072172113095510678771 -1.4879140588899963937 -1.3696525437386444235 0.21788575459366943399 -0.012720156870403537264;-0.28559948484593927764 1.451931567766890474 -1.1682448239075224894 -0.64732308765432955422 -0.18143514175588379422 0.14791337222619890812;-0.37754918076216542611 1.3033014592608744842 0.15897821981670420821 -1.7464446363956001029 0.099381136792902058374 -0.59268771545165321868;-0.431238571945763427 1.22036829879369213 -0.7609439470595485977 -1.2234613165716901051 0.077667685174990855335 -0.98357351699608264184;-0.45697463309480612637 -0.32516086846040143099 -0.38457515888978860419 -1.6918595576769754896 -1.1305869407735658072 -0.79469818038984130215;-0.7321004411769710396 0.82000979096069570584 -1.1660055339796442375 0.31611390815335099758 -0.80283933693929832032 0.86684648225279381517];

% Layer 2
b2 = [1.7073756943235134376;1.3864514788006427892;-0.83982952395042753668;0.47622670653998699919;-0.10708858661431212844;-0.34256515721232977389;0.5785293171942278434;0.67002403957696232695;1.2457333828227263872;1.593136553312307413];
LW2_1 = [-0.11422653778576995209 0.016267548961117667822 0.35582145247284902023 -0.66708039772054994465 0.061335230565576728812 0.14064705674749763964 -0.16301474795864950851 -0.40449307024858410786 -0.16756634014487925555 0.31857317658955736084 0.38038164010682617988 0.44329792392369044007 -0.14024147351136925788 -0.27236988910742698788 0.33116130548341382589 0.071113426555593703404 -0.2803391027252924439 -0.45455563958109507228 -0.56788921927677471491 0.25866421605449435583;-0.33604613140815681183 -0.57495158830382198101 -0.69889508263808253208 -0.23371360957186460006 -0.38251212277713758647 -0.79630646591917964017 -0.17272082598013435706 0.180364232359544574 -0.29601073941142552748 -0.071268719240227998424 -0.079187798087803865088 -0.2785781446857442667 0.31458446778680432265 0.26091387543324490172 0.60406523307104742493 2.2641306853486524442e-05 -0.20432395810324674446 0.028037121185758975828 -0.008487422468677998863 -0.52061186901720901687;0.14680753042277075449 -0.063389833046948410034 0.024265002491837450033 0.061568695924368421757 -0.026206784130061323151 -0.042966291803444932318 -0.20134483482059617465 -0.83749093225765303128 0.076707167436728410093 -0.28412816321434097855 -0.057888998178317177534 0.13200146869387474613 -0.12307998404522570157 -0.24494339898537270672 -0.068108888181746332635 -0.29346384300887251584 -0.23925024613338982671 -0.23590812890276899316 -0.029801529056988511346 -0.25127374780951305944;-0.48878108759283100948 -0.0065420558892679385454 0.68948624682736714409 -0.072538410685716203652 0.1353416509944459778 0.063627827042800552682 -0.30685756231410871164 0.79940642147556517649 -0.13833403483814857293 -0.099142262102004719004 0.018427570481389828061 0.49509248085872475942 -0.34854960954271418938 -0.37446639134001580285 -0.19632551028997671794 -0.40144579290051812803 -0.23850606010143141078 -0.17828192698292666396 0.043879926596982310461 0.11068970534201298672;0.69125461151070666244 0.61738699047228351446 0.11826105550584252446 -0.31276795109224814206 -0.5136519203578203685 0.2637149635689661209 0.12454231656401859585 -0.29443859659383686544 -0.39608312729685207776 0.31181545371586855131 -0.32566729451970277687 -0.33796867636288102643 -0.38849718192305732201 -0.38289401783586879402 0.41633910010915264888 0.080734089353076188278 0.54036914798522073244 0.046148311440951016171 -0.21190750579229936101 0.0062153802584770916767;-0.24483302759121419734 0.50326849382018490342 0.37973071371112171457 0.18942033693363982683 -0.53767637765867204447 0.42000003505752880884 0.034074659464983558799 0.32964654881656590968 -0.27293057321173136431 0.43624727424095249839 -0.36342994521205584935 0.099707091938297534583 0.36671196981163767248 -0.32951131763762581128 0.2084202710252441304 0.44106167154409242626 -0.26251001261236128759 0.25089364598404728657 0.54944677315978229792 0.61796754935218656257;0.16812650666074546724 -0.17235755126028665107 -0.3263095163954782274 0.1969509195625224196 -0.27659815162206685679 -0.16936612202530554327 -0.29162751912074902361 0.41161077314922700499 -0.046744043325643205855 -0.1520396106874996045 -0.0014057157206932603677 0.70980418330089611878 -0.15968556312295273392 0.23108301065196770741 0.27326549878290196105 0.21108713788649441367 -0.5233741292832028158 0.24737933236123690883 -0.3775612194121306664 0.34874165754081931645;0.2908841584849188866 -0.23733728001316176104 0.10262731744003125711 0.061994868607556471996 -0.22825255520880399773 -0.089396676375093311884 -0.36116263425421113453 -0.62022966819921543369 -0.19837812707993596195 -0.28582785092465573529 -0.098222189355941555422 0.31010901513325839218 -0.16770184368691404275 0.35902555669737712396 0.17366695851283159291 0.57831178652280701424 -0.14096891263790370386 0.3213121726118440824 -0.55805372222889371159 0.44370446403453783768;0.55056206352198988618 -0.29149256036684373372 0.28012471412549289074 -0.002745135613861384577 0.50904523833024983848 -0.31703435308017269278 -0.098364084779411609105 0.20880858151055206595 -0.11347593278887650736 0.028642511441016899054 0.011431249424151995742 -0.12162905973669414783 -0.61801044362032298007 -0.24055957369754576991 0.1729240263987035231 0.39986484048747650277 0.034512995806209777194 -0.42970814730678735804 0.14041617052788615827 0.3591324838073584047;0.22602733694129842346 -0.60574242364273744865 -0.53767921016147479651 -0.1652573839254027066 0.381124669261891591 0.0049395511795629881008 0.33093842934964745606 0.44906453095162091049 0.42393841503879414745 -0.10768108998717369762 0.43828204615247962073 -0.36866250532145355967 0.5637372869934965669 0.34300263955157678231 0.30332559357527327792 -0.19427517847522593475 0.40277472252349194592 0.044432426699022170569 0.13952554302794217822 0.1443370197104835162];

% Layer 3
b3 = [-1.8855503450418218403;-1.7074884256696638563;-1.4528799650486730055;-1.3852685768954831058;-1.1438780466682856307;-0.83313717445947854667;0.82569572357796472417;0.3598239036980525607;-0.48790612596863652817;0.023206682433899485096;0.054781267055126960097;0.26526104015830637151;0.46704388656210826802;0.66062224666587965327;-0.86213323417083764788;1.1338529094856881763;1.2994314227686869501;1.5065500587520876952;1.66267406426745179;-1.8892177399912517544];
LW3_2 = [0.51793615412867743952 -0.5802374751783739848 -0.60404409473110176609 0.060737279644954976499 -0.52093112534609731235 0.80211561727652813669 -0.052633041847472791797 1.0833623368113647345 -0.4507978882744603788 -0.54559149311831733886;0.059783604536318951661 -0.34394040339118797656 -1.2132724376425814139 0.16628835040826828173 0.0033288162940530033676 -0.080643418686932269446 0.079128070326395863465 -0.4909690722741367197 0.69245955521851954018 -1.092079983883060379;0.97122624203124463538 0.18853164707038094772 0.20404635933234102629 0.28992377230916061004 0.058066074498306557983 0.95616625155280432491 -0.78120601348213625226 -0.076761411493848102916 1.0101619833707753404 -0.064748090094572191555;0.52508388536746986031 -0.16042907874717157735 -1.3244752101734642569 -0.0073391573022103277421 -0.14108327504451093071 0.14389715556953333597 -0.64727095366766618234 0.3289557525625891321 -0.80647741593502819679 -0.45296104051634200616;0.39280835928340163132 0.72908808144119374717 -0.30773261941079010917 -0.87992916432765455603 -0.85379795031526539706 -0.35347272998256290544 0.52154394989237806701 0.57804173841612727092 0.59247758702716379897 0.24351206266545036283;0.24714362697401509594 -0.82407605385405102716 0.5711590759776462578 -0.65484508128026142071 0.68290398390422324404 0.95692740104410389801 0.20455494167004806272 0.29696178385474342187 0.39673140041309923332 -0.62710945833535725047;-0.54603523575307144622 0.56003302692145240371 -0.53259953234327139793 0.29325308532066063361 -0.40825740159825096853 0.40934734455870663838 -0.14524620835291404686 0.59315598101218791616 -0.81859551440185118754 0.2596865748723570233;-0.70593602083200057695 -0.77990112166689185003 0.45580754916362387075 -0.16413265663256168536 0.13820258854528405523 -0.42772433478732729828 -0.60563583673141430097 0.72926560897701564468 0.25447203064535167671 0.2443938061432444353;0.53241581823068573343 0.14079732637295655495 0.19422694711546631408 0.2485244412718427276 0.681110915052585697 -0.22985383277257182 0.79719971499813613303 0.14013698064767141083 0.79765777784501734615 -1.045285112272205108;-0.60140135380281134481 0.71035199599564347039 -0.57034367478782965755 0.41569670302134703599 -0.61261272944311095934 -0.31818845376623416943 -0.70848543103364047813 0.8590366174304987501 0.1003552582769921403 0.25638649111655748003;0.75716268847038104006 -0.23113192825750583648 0.46268186784719511628 -0.82078010551331070932 -0.49474582293398516875 -0.021237091368258059071 -0.22602072932543268435 -0.67841817693786798937 0.82787318401761211817 0.65803873941961554817;0.5968987820307347647 -0.4254168778049976507 -0.57148850381055238401 0.6486876589843801888 -0.42568391631628371696 -0.76121890949907788926 0.74507681929485036765 -0.63786048698825426051 0.63703913808733569901 0.35086072149986619051;0.60426933888115874627 -0.74665682895496687799 -0.2242275273586527562 0.51353629924931942785 0.042835971132700670361 0.32883618748141846266 0.78139930341425900551 -1.0184135485810879018 0.50210083365504909469 0.52544560681007146385;0.65699161629992808287 -0.78600937782585644786 0.34735651675902279312 0.083607533587443536027 -0.52561451856815599726 0.98046904360550879431 0.17075335808634106716 -0.066123925352910728481 0.24482970276439539048 -1.0038403765622678776;-0.4194597123877576994 0.84893619048599766597 -0.25542579106540636014 0.53822244740802105412 -0.6278703069534998793 -0.4189331737482926421 0.85479388226210906154 -0.32082315417941936753 -0.49147639261383718745 -0.79218438522728196194;0.44002618807631938003 0.49244855866584158477 -0.34514874823029528805 -0.7785212080272129187 -0.79666395738158946038 0.72199250422067384747 0.65035351453104139896 0.67683965382715527426 0.62902802238049837502 0.26007911174248732333;0.95179278305937864424 -0.20148944707245503016 -0.19894729781614400865 0.81402919660120898193 0.59484148409968984339 -0.37478392520874020954 0.28830505356127156258 0.75556322956872112862 0.5064798515540160917 -0.59330449983624866661;0.49975023543260199688 -0.34466048591973269533 0.193755377957498226 0.26799070776196287635 -0.03997300130458966011 -0.64665244586648851222 -0.99343803470811931078 0.88820388845875097861 0.79116699190549744092 -0.49094434715363843846;0.90163852952912015848 -0.40934506193597253176 -0.56004462801961729657 -0.067136628547500812325 -0.726876263245830323 0.53789845048025086705 0.48009646720176285539 -0.083407028542482233857 -0.50792169977332912723 0.97840644616295824321;-0.60551331670854946498 -0.59710486049768352057 -0.60402483723287436757 -0.726427363119559244 -0.39617732280111211951 0.70976353425138638542 -0.55470009457323365964 0.80532619134140293049 0.022919015198608932299 -0.57869734420755059023];

% Layer 4
b4 = [0.635124792175719044;-0.2879555871118172905;-0.56167993432948959409];
LW4_3 = [0.015066652319227135867 -0.30741321023330842044 0.36186245609328482331 -0.70585090304009345807 -0.37472634981140995336 0.884077071061368569 -0.5798530727865011114 0.4263561197376021239 -0.71870075476367356604 0.0048833926504684189995 0.34392755761892224164 0.32525111902373354811 -0.69406056728313858528 -0.31969579385879287603 -0.17246615961254230243 0.94674294170734762943 0.53229929358145677831 -0.85083134003381788446 -0.49213319491788892757 0.61773693493232562091;0.012511462671141251185 -0.24922129705117826437 -0.43119222059756906473 -0.19143622553467687375 -0.076259266378977022538 1.1098890098287421679 -0.078622560134659971731 -0.5334357905424599311 0.36496795021571565298 0.75215450781619053178 -0.69923936677411102636 0.45910201429861013933 0.69304356603993844121 -0.78083728548101671851 0.18803576464173227256 -0.032464611903991184849 0.34027600384919476362 -1.1771707056092297616 -0.2137612007620244281 -0.62950892020129722848;-0.079638379655336821727 0.13818755843215188572 0.52689851611441618218 0.32972549532459338728 0.78526550142666495802 0.37725355651984898708 0.18168262705553758773 -1.2092679902574035022 -0.032631835981982618144 -0.62421623457652553046 -0.4520450654872506524 0.51721786172581385443 0.18561315432283614912 -0.98836872471915515614 0.42995883912844934382 0.72657599659041005591 0.54847653425186915221 0.24992345201699089907 -0.16584980980687058505 0.67351967022374059635];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [1;1.52644715684904;3.83726037026737];
y1_step1.xoffset = [-1;-0.648877404999098;-0.268243789672852];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
