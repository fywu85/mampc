function [Y,Xf,Af] = nnmove_04(X,~,~)
%NNMOVE_04 neural network simulation function.
%
% Auto-generated by MATLAB, 29-Jun-2022 02:44:12.
% 
% [Y] = nnmove_04(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 3xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.621824661365331;-6.76356635189084;-1.22678659261612;-18.9503747203821;-0.966499157220955;-20.9469586519853];
x1_step1.gain = [1.55472084947336;0.166237204225599;0.861612382024867;0.0494590081697823;0.970037796354946;0.0506079346442846];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.3703418816308094996;-2.1238731419652787658;-1.9292733110167992194;-1.8995780820309893233;1.3391619341390892384;-1.2692035758338886531;0.23072300337325574171;-0.96880570546586264324;0.63526754365504334299;-0.014732045299522255125;0.23772321553722444709;-0.5320134480548722733;1.2065146576531395883;-1.0245872486022689074;1.2053837450157942612;-1.2919746733569144048;1.5886675749493106569;-1.5396459341924810804;-2.0501768818585048848;2.4541982417058556543];
IW1_1 = [-1.1742328627729394785 -0.87979065999995686997 -1.0262840875474954494 -0.61429974167048562173 0.74296854824173486076 0.78660554318141928665;1.3586405028769543701 0.95200470947092585838 0.87078971707692409687 -1.0013459388508980652 -0.60024916037192888041 -0.45073104265516034106;1.0776152867332462471 0.83154121747600484582 -0.15722944885936951387 0.036396228348492862259 -1.3249756672998345142 0.85710639512000719176;0.57777910204569338237 -0.24694135805333947142 -0.45345908168755855172 0.9354562493964758696 0.90988343832352969187 -1.5635695969859177978;-0.55828411806578692733 -1.4350650413751286916 1.2869136510196177436 -0.098419684549615638058 0.79447392897712476589 -0.48364635629272723083;-0.12380921498480633447 1.0746376783570470437 0.26439226080609257163 -0.53802688253864949797 1.1568027317467255433 -1.3918704525113332338;0.062654730973002989436 0.42526557893854211034 -0.69405713011152314618 -1.3462715544021590652 -0.5069140493962113192 -0.96463681781556653849;0.56734707539613671301 1.0711409417489416995 -0.42067188625185641948 -1.1416160010899911725 0.29120341950760642025 -0.086721301910509043798;-0.14807578157830716958 -0.95376125096211850085 0.88942598003645878535 -0.98547424347960244084 0.29440222283880351783 -0.83679248064294742271;-1.1794343138320506625 0.63693690664780666655 -0.75512579681557001621 -0.45149174601842656518 1.167364632365124999 0.51999579068098311652;-1.3403263370383418085 -0.72181470623625032523 0.15173647149923283339 1.064977891452326908 -0.21456429917588248912 -0.36704272180087277322;-0.1457958398997381555 0.91753915911291916707 -1.1639489577069339621 1.0528088057875581995 -0.83484517459639351333 -1.055081167512968765;-0.11760682874131357656 0.41514232722347366167 0.74131795036075609495 1.1533655338750021802 0.21726493107182040521 -0.26248946625533492449;-0.72486023942414934407 -0.092009416329250734434 1.3453318672027188008 0.55319479574951824219 -0.26443719974853313603 -0.78270291658899415754;1.1583924685230608809 -0.18689644644675199037 -1.3321147912387645285 0.32264409689693690497 0.54894421327156828205 1.0000253651802684107;-0.27795666608878144554 0.4754192927453252393 0.11069360254973095725 -0.92495174944988389765 1.0162917704935228169 -1.56761560022645563;0.55469572325786831168 1.638451445926282668 0.24901800577431998374 -0.96441389794804932567 0.43031298508583859519 0.082280399828221981173;-1.4521513020161260776 -0.78840334757456143056 -0.40451721776599897096 1.1174355802058004716 0.48595418309658972023 0.45638264559010877086;-0.81321341597276008972 0.39194673219794096131 -0.2272045206268206996 -1.5747103968462849988 1.3140577870348346678 -0.47910243809713076724;0.22335779095077326617 -0.050071415822591509859 -1.395239284345387798 0.56439718228976687442 -0.15545875850560983422 1.3572443489249472748];

% Layer 2
b2 = [-1.5913985097578349226;-1.1742083145101898101;0.73661291566692888022;0.61308911521002984468;-0.010058754640090795951;-0.15210806078584152012;0.56721329841770429248;0.78693810321471857616;-1.4403585896878605688;1.5032519863698965423];
LW2_1 = [-0.22348512175256912693 0.22954144848993188188 0.34806463067630483144 0.20924703249997050891 0.61621256274825342292 -0.10854105209426999357 -0.36412779786225407674 -0.27237826591616665084 0.43036653784889739027 0.13486851538231658942 0.47232756607251386027 0.72174719516387764173 0.28855504357045763664 0.19470269592530434211 0.33844629163398459726 -0.060502363490205650354 -0.18174937598356805113 -0.47378281833520113908 -0.023562699409184716809 -0.55284530919706553753;0.38745136520108131029 0.0075715356571789110135 0.13052447930942287502 0.30740515607899115968 0.28693535181227741715 0.84584918133780939709 0.85075429712176053876 0.32590976618527289776 -0.45956433465436291597 -0.51408296144368392788 -0.58084949687278375485 0.18945718879363354636 -0.095465678228898523394 -0.024641086048283883381 0.30320369041650607755 -0.21725849188926982247 -0.28572807932487492844 -0.51237053864030757122 -0.13059443664201558777 -0.031806946472819001837;-0.068884733354551364037 -0.17496863647785207418 0.31941674645689233092 0.23433779911990307299 -0.45351452016441201609 0.33759870395296076584 -0.57029129223576024987 -0.11649649684794785576 0.73567445849297952165 0.070066188665038470207 -0.54238853847397094921 0.37417264061572030887 -0.5120550294528707358 -0.21051418804346955227 0.18044403695330507587 -0.34042776169122063168 0.11352306238105684677 0.16550389775356716404 0.28467541988980787915 0.055118049844759015032;-0.23868002876721478023 -0.13300109239032706365 0.097050141346268520293 0.025511756410679212875 0.1078230571460410403 0.0047339606772717965355 0.32841427437441861326 0.019194001662041347556 0.017905042946473680165 0.11428729099099696476 -0.1942363090463778974 0.065222118978744442197 -0.44496215892983831397 -0.26356408948886916876 -0.029785041788256236273 0.016745025618140885887 0.5133089453431437521 -0.41621576208239557948 0.22121831930681887246 -0.32971262565242842602;0.51259344801812622983 0.12492258251468289776 -0.063016392283521960316 0.0082037601938794897649 -0.35433301913888037848 -0.36214964627705126254 0.26330498036879607104 0.68367992158870427577 0.48579514326944739366 -0.072998533835448589646 0.12105281502681200512 0.24018182743772931165 -0.28663402984062591461 -0.38287649621714409109 -0.1471788708508804111 0.53127974710551939541 -0.18219931146295334501 0.7414505173967138596 -0.44751134752963500629 0.46306388282436672377;-0.26247598313823577998 -0.5530127528179428209 0.32443656198561315884 -0.1779894225864414592 0.30306660970832877133 -0.095286179195335440895 -0.3690911273818052174 0.23516698951534242834 -0.13071675282925684924 -0.083590205966245542668 -0.24281391802795626589 -0.33936350784632884903 0.1719469015949202928 0.12349284631792356581 0.37389279182166718085 0.41821838233062147427 0.50425103643094715267 0.078587098706441357865 -0.42406078290932003316 0.32611583776394043044;-0.27849371016920837496 -0.22340319400700964225 0.075453469721676880155 -0.13113497889272129893 0.10234763196654675377 0.34724339549270416549 0.079738413602005966951 0.0077715636815641267465 -0.4957743859777898332 -0.16275575575690295893 -0.66339380136151038236 -0.39710731986216202261 -0.073106295098315995928 0.3169379877203138407 0.7555421027281352675 0.031362880847261701001 -0.56968249818444760546 -0.1289159154967279286 0.27152922871434220786 0.0092143548994446482225;-0.025392548021601832331 -0.17498382729019293369 0.24916211871674526224 0.19584484862520415427 -0.24945982479594530634 -0.014621824235240258108 0.51749896472447398654 -0.32716639043905837436 0.40879678496580817981 0.036832096860305918451 0.34822410369117984263 0.070041498437570501312 -0.20957648797664604756 -0.33202000372872703116 -0.21665964576158000532 -0.34436232642625946854 -0.50995666078702062141 -0.34679337020435963002 0.14065218312195912342 -0.66035230214310403074;-0.39291356092886525753 -0.27461200602687357852 0.398934132355086013 0.34479181409938830516 -0.28758237465698549551 0.27079151989512562082 0.069011362140830340151 0.055425965814758455796 0.54364715706396993244 -0.75106781896385599318 -0.57216015751299942327 -0.063431180025545902401 0.088256264905114831243 -0.51354963354501059758 -0.44928456757212076322 -0.086121794963137363044 -0.26470735627298280779 0.030929307733894600974 -0.25917071377165201707 -0.23741169492601615909;0.24120617462838012113 0.1320422888805555528 0.15385585305619239871 0.077797594873011494121 -0.2272586949942331791 0.12502372074038370364 0.24186399163941343926 0.74315290818728185762 0.26813530374184785243 -0.21588414506908154555 -0.1722108428453053286 0.11634755074261157737 0.11345052524356823154 0.50524220102541794741 0.26313445163985998976 -0.24767089789244969844 -0.25578594583055996869 0.097098960769294292983 -0.14064142945359348058 -0.39526881830484539293];

% Layer 3
b3 = [-1.8245241147274777749;1.7771288563482485756;-1.490603946177297745;1.4044044292808501861;-0.66600589955506339646;-0.73128287827192894888;0.69993403854984304058;-0.46884639886557460953;-0.29651568059226934837;0.31178766709930466616;-0.045637119474820089793;0.078500139444109565123;0.25416086132005843989;0.73945934314599970349;-0.93237000897627142493;-1.1882180582538031111;-1.3091305231356014094;-1.2784621203527271049;1.7935638071781945246;1.7587884411156105013];
LW3_2 = [0.68327106221637745609 -0.47708707813314388257 -0.86263341003524818262 -0.72791146794464844927 -0.67510920537965912747 -0.19526106657499814334 0.54572294193924075767 0.1897939446494246174 0.73176202683305779928 0.52240861135756055944;-0.36230390850216270815 0.55279112863334989303 -0.17043616273776873715 -0.25581711529084794066 -0.11677402782350268517 0.71087616972224787482 0.60425926830680587454 -0.017408711146597623254 0.86776877240612160236 0.80019518287237434429;0.76806929037126170368 0.54286342142454957482 -0.48967499217767063158 0.28611416393444560891 0.64627110940034082631 -0.53044649603540816596 -0.031826657830506872859 -0.25738355204826707245 1.1180905942243364315 -0.58766965743520904741;-1.021143087063704602 0.37683379603090877419 -0.50430005776618669344 0.12772273683776053099 0.65082563692673012223 0.16513482053442551933 -0.17389002002709519346 -0.66929221446395115169 0.88955002655981807447 0.33690134585290826275;0.11834632873574695011 -0.13513795875318707074 0.58225657356210369642 1.061062130312113494 1.0538675756924431592 -0.031901710977884453757 -0.23975730549748305864 0.24801999440155911292 0.71696749164814754796 0.96619709214994242696;0.4498351528201189331 -0.25957663787050039295 -0.26018489567397273809 -0.28278164095171953729 -0.54895440565674313849 1.0693713807431963758 -0.44958670817206908277 -0.14593360576487085511 -0.034119337657182342849 0.91401659578173943821;-0.1145931326671653927 0.055835232891882996542 0.54690029364702530401 -1.0516233712695037816 -0.45505036425821487889 -0.14846146604557375337 0.3947762812361046425 0.46799388019615517642 -0.24151919107768626827 -0.34965742503191815649;0.0046140062039357297718 -0.23719303701023100595 -0.56638577797258216062 0.7584863078909445111 -0.63887983400799397415 0.98171681270578736722 0.10422740045874404058 0.75480297710936983258 -0.76066689855794911157 -0.33752878361121002593;0.095255030647425922852 0.042271113594097811661 -0.58059902284040887377 0.69158410976631146116 -0.47079807139376361746 -0.86355239268398475971 -0.67238795228304260032 0.13201350306931056156 0.41340124020129265237 -0.7855673010977848314;-1.0413648262904962039 -0.47086338059143567625 -0.6016528802390354036 -0.15953695154104771681 -0.68297129602654138569 -0.498041400305449522 -0.19907487994429701184 0.54946066150140537854 -0.23335077441391416375 0.82748038303894311252;0.65109151697444300755 0.75993245924649044376 -0.39989367022419985975 -0.74979557047542888526 -0.13946966846681529972 0.34638648369808328065 -0.56585733593274001318 -0.64947453961623557994 -0.5712595970916651833 -0.38041656721278244158;0.82808036003434493111 0.76186290595394456915 -0.87762975589582670199 -1.0216546507588160075 0.068609358079527296703 -0.54545519898165784056 0.27626495831568859129 0.28376680222599737213 0.71301022888371512476 0.49605579600553262321;0.90834113460007614993 -0.38053971165455141579 0.2512278509648186442 -1.2120035543694998026 0.16180224452626210119 0.63888290919374679522 -0.26529740240579280375 0.51864954969935006535 -0.36885789002419799854 0.33514782103336354657;0.36994218373364917696 -0.49212402004333788419 -0.0264124002856635752 -0.98443399244973750495 0.63023588791455165126 0.18447074751922187819 0.57110507412748923173 -0.20727723038258347166 -0.53599980320760087782 -0.87654201434967726758;-0.61265632018698146233 -0.76025604752894404559 0.52402550844154083265 0.53453581449637044276 -0.010610442867837853106 -0.8133665876587438115 0.71231462765200725951 -0.1519313574612222717 -0.014985526282882048396 0.50230082175693036017;-0.57645618243634222377 -0.85934668719019113858 -1.0433467479891163077 0.56981223380121859279 0.13901441716080889521 -0.40077055384984416886 -0.049288833238605021803 0.444286243068987452 -0.18186719894821468113 -0.63302427059644206242;-0.41477729828142151369 -0.79401771765441431228 -0.0078965760220305152017 -0.31076934342554096702 1.1713270919334379805 0.86535460068042946435 0.27915496117498861395 -0.15681093215776073513 -0.0088620911255566890696 0.62985127348896963184;-0.67979817579041867948 -0.76816792390516352995 1.0903089718882674752 0.95646596900053615364 -0.54662996640625194367 0.059884742734695101118 -0.12152945386252693438 0.64302481627671270736 -0.82239017848714168757 0.19317006028721886435;0.2435822931671262348 0.76130997732203675721 -0.59244756615313198811 -0.41364664434585962649 0.35117167361559809002 -0.50482729502628131968 -0.41574127580052094855 -0.61446695914577442732 0.74353067283306206736 -0.39428427457222969821;0.15386298337788098523 0.42367327765034212828 -0.70122121563648298626 0.0062968565985607547614 0.16015398083888315872 -0.42918235943202315275 0.47713951592479963981 0.64845233696461501705 0.77100444815735491577 -0.8539646882158672403];

% Layer 4
b4 = [0.27502506284317662644;0.70011476991788790247;-0.28495923908116682632];
LW4_3 = [0.59078258936676697477 0.60176203465072908294 0.89133341170061342051 0.29839785925214251661 -0.45266026860764979611 -0.26233250080574066487 0.28507308446513990319 0.066056906735284054433 -0.27758244265203851908 -0.38332722914976058437 -0.10136593941179866674 0.16327992020406761897 1.0444017059803665237 0.71373804475642899092 0.17610177759061770852 -0.084751759219480193863 -0.70762569602134950397 0.55746846355132473327 0.65380584229136040619 0.019218675890896812219;-0.34331848114298385566 -0.31767663607408924697 -0.13354920944936221616 0.74933198318191585052 0.38374702112184960745 -0.074334394585962748625 -0.72393445059834804489 0.3369143733623834458 0.16198954581371974304 -0.49308115919448947118 0.1997192851563367455 0.58816687543726597909 -0.48637864333352692769 -0.45996840981924586034 0.06223617785624386417 0.028058492422036212383 0.31339649454080475977 -0.50834215294862294954 -0.83219774821777803275 0.26605790048805871839;0.28691253618758338906 -0.65688968544911363612 -0.38237571500558037441 1.0794271247292419602 0.47559711741929039386 0.30866027523751216055 -0.7501973339630149118 0.036998635143306979334 -0.12212547812941619563 0.099359459776523884056 -0.26966096189813432149 -0.28532083166638949612 -0.08708382511089673983 -0.50966026166018207899 0.31109882471625238676 -0.026366707931796514591 -0.042396405468942112427 -0.62646393936179012307 -0.48954009215648353059 0.57861360509719661493];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [1;1.54004814031226;3.69745084394005];
y1_step1.xoffset = [-1;-0.636263333787975;-0.266518115997314];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
