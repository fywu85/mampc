function [Y,Xf,Af] = nnmove_04(X,~,~)
%NNMOVE_04 neural network simulation function.
%
% Auto-generated by MATLAB, 26-Jun-2022 14:48:27.
% 
% [Y] = nnmove_04(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 3xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.538969769082243;-7.90783436538401;-1.02702352576879;-20.7368572510006;-1.24089441979988;-28.1236733477122];
x1_step1.gain = [1.81393610359949;0.122239026161682;0.875047220567484;0.0413214883755997;0.948066863281678;0.03997546016413];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.5058362352833842834;2.3689500394329434663;-2.1514713432575285346;1.643887483214126588;-1.7422269760982502795;1.1196822740194105616;-0.16694443407559139692;0.57205496210586292971;0.67020812277049868211;-0.24814253173496597649;-0.31570316348952032204;0.24399300112047708766;-0.86170187777077678071;1.2791954533780081071;-0.89102632527124125961;1.4406858432975644391;1.4827528655977117999;1.9045563107225866872;-2.1420529861570476449;2.5175258165591767323];
IW1_1 = [1.1846386057915103684 -0.73279798140561969166 0.82492377019225937573 -0.88772061399539259341 -0.75850237033785894436 -0.43637857540980617976;-0.21205333287468278169 -0.50450298319342523623 0.77862461576050756573 0.9486899105401335186 -0.15670808859744353447 1.7260083613433123695;0.1640361720309811977 1.2510630021445159343 1.1668594998195844781 -0.76965574516988710663 0.29995348106468083804 1.0095134631555182647;0.11252844846280314617 -1.0721958444009560552 1.0190655565343031963 1.1098612166192409756 -0.86399026219026209272 -0.18452049795351352368;0.61193624659090073425 1.4357612493185127889 -1.0607590273459219787 1.5566746345189512724 0.50201039543608860782 -0.72871195770987284845;-1.160017831475828487 -1.0425585252479663279 -0.94851059944724802619 -0.68752988653711932798 0.9442386195541893068 -0.71697390452017817353;0.95344120407536769868 1.5703399864550044995 -0.24771579066704596528 -0.18368185404714332254 0.53355548299417521196 0.49238247531220186159;-0.27109204392675273487 -0.60837088219878365791 0.33356230311072332384 1.1463589892967647188 0.24196241832717052533 0.55061436089462223453;-0.87913315479399045671 1.1724949708163836526 -0.73352318322806209228 -0.95956218034334250788 0.23176432071043898131 0.55052897679907875084;0.064107337286086141237 0.81979667381113352498 1.054442308521760685 -1.2376666401252982563 0.69229830180634521763 0.80905954421942016808;-0.61635304859652917386 -0.83899567203206693033 0.047046570713558652499 -0.84900854534099245985 0.75034334949915426627 1.1092174841407083097;0.15204974608314256179 -0.46918420470837218783 -1.3285049409431659573 1.167217023810494414 -0.050784106109922982908 0.84195350865035689658;-1.0736188558689037098 0.090882656081902962741 -0.39371888520604442219 -0.86177409129198712101 0.94915337590028092674 -0.72756788471975508692;0.26823092122884467647 0.060192582534375531356 -1.5261883722364419924 0.98499555042176178965 -0.9186627297400928871 0.1509255640159611056;-0.50496259880751526161 1.2409644724173392039 -1.0772742804234591851 0.39825986650450151405 0.77011158930831458136 -0.87483640015318187011;0.24018023321079723376 0.57476956129642897686 -1.1230847172791842414 0.55720405892035296258 0.042632747043680099819 -1.6973119667166949309;0.67118213800755566201 0.020108057179878027765 -1.3411397003157059515 -1.2631597757490011791 -0.011094990375487556733 0.22408816282797899833;0.33993633960448088605 -0.27075322538180485177 1.0231108277218647906 1.3634160497361009767 -0.6487832109941826797 0.83753187220983549288;-0.36892214748493534771 0.897705307161659527 -0.22708907992779570062 -0.44527491642488253865 -0.037508879072120554499 -1.6402081877427467926;0.70121959234797814897 -0.99354316921675356333 -1.1630805155073886681 -0.50652816888005702811 1.0882538393687484213 0.4517870125334384479];

% Layer 2
b2 = [1.7093015991144235866;-1.3424528055122750825;1.0242003217142088278;-0.53996516268972005737;-0.17374413000581906408;-0.38529765591446579753;-0.36232748532503439298;0.7499204254718971896;-1.1032127023220774653;-1.7313167049585085344];
LW2_1 = [-0.41668893581258920067 -0.41089765677201328664 -0.60213301683952225041 0.35348804560137858655 -0.048143728767228444188 0.28369761698126416682 0.03884963788641702942 -0.39413828939525713535 -0.47599665299341958891 -0.054256695811054994616 -0.45608207684654422653 -0.29577454802191627259 -0.33079462189255015581 0.27192787946412494415 -0.48042909181435428101 -0.13674089075295522977 0.42106719983542689745 0.29357116287040113667 -0.20287596247570907626 0.0052080836093791639529;0.24089064335695328789 -0.45926999780633259718 0.69560096555213013492 0.082980248999328487525 -0.38498163164226129052 0.1419737660102089738 0.24559640260891937857 0.078416827430722715886 -0.39674979737618670805 -0.41047810572419773933 0.0073819999148562777391 0.2958276655913902875 0.13902806593675062774 0.36354623136629998781 -0.32270975349564112733 0.066790983428862860105 -0.6818953612017084609 -0.27364836714359336289 0.31892758657871367323 0.12618782819035664899;-0.3046899839781235797 0.54134221693392292618 0.029735042476740219941 -0.24767160254018549814 0.08335885726959671449 0.34569195598904950417 0.46220244784415226436 0.29174314209864993241 -0.42390029330913636674 -0.43528800704781434039 0.53734559109515211972 0.088158331725948044233 0.13382661496484593577 0.67148336560808419282 -0.28198826358323714203 0.36518074300140612731 0.58504381116653858541 0.37712955211716153725 0.14639510838137811954 0.15577524830047906335;0.33997803205295595852 -0.23466321622747715603 0.022781815471190389188 0.024517018721414166049 0.0085008298394738737724 0.072387674388510472867 0.30678261755245078701 1.0968623584530099446 -0.077395390908705702371 0.29533290923228866509 0.036413180549138828013 0.15639049764327261904 -0.038933191349086092303 0.054646440145970677504 0.069494632666776634533 -0.12644964397058783279 0.060327713202538865711 0.044976747597795421751 -0.2206567364089071781 -0.091155661432752888018;0.52683047033261054537 0.45237778161408265243 -0.31115301182039012406 -0.39544049867156705336 -0.42727660447319526504 0.10886257800482715408 -0.25680324861668268888 -0.2521115175363627392 -0.10382250818134935999 -0.40687187586382717042 0.24997617453289200373 0.12013975392029424549 -0.41072683130499837434 0.12860633566421067475 0.4366064316071844309 0.53918893436345749492 0.65116416597509441111 0.45276117071492477661 -0.22427060229047693363 0.26491954636651982025;-0.39801924773875679842 -0.52972924570899293517 0.026113994240159414673 -0.14671032685404758467 -0.21234816392906807891 -0.02278864561684685458 -0.33562973112561284017 0.17551888173816318495 0.23204429725069117274 -0.49872301306927763198 0.10383938210897547538 0.13793097073243204553 0.01101183734490078503 -0.44227350336210308202 -0.077017633588610551199 -0.1145732698956501705 -0.29150291856545740288 0.072581789070961161281 -0.28946254957752937109 -0.095685208521397793757;-0.40498681824289961551 0.44498744453185962167 -0.68083857805127634411 0.34552482198832878968 -0.047028052518206381327 -0.26805607476421683399 0.15343032097465722496 0.073542377260203989353 0.15207313824462667662 -0.0057607909242601146316 -0.1789324682664052979 0.098322763317153727414 -0.28964680659935976292 -0.50033495250659432152 -0.089915211562699784431 0.48373342572211674995 0.29201629992108302236 0.17521445482814079764 -0.39811996251885833908 -0.10083342347386307913;0.35592782028830111107 -0.26903762521130486496 -0.32268146352878429584 -0.09737456108381779829 0.29363287374864743828 -0.27302189974800006311 -0.41712675991909897721 -0.39034268250945625134 -0.032658832006601662412 0.059319350370415552254 0.26485623788325962646 0.44444600866653916071 -0.46629777735136596073 -0.21784883975387511756 0.52471423304820785649 -0.52923828322333643648 -0.075391311260896959334 -0.44235961956708313991 0.1305854729669630454 -0.18440647831918016708;-0.19049104925345616834 0.50378415314216817844 0.060474702867050353361 0.008713640622453572987 -0.10479059272764319755 -0.02872323810225867538 -0.15203020189169377807 1.0902812241373824875 0.041597303152786840874 -0.13194129679441457537 -0.081412293712140260116 -0.070096437175410433729 0.020827937642554049391 -0.050694246691191630072 -0.050872571497387782113 0.00087986229271766469573 -0.16418616115316098103 -0.06952499540919435117 -0.13356472020669382661 0.11853591551112664659;0.14133289691338257743 0.15450145494883277264 -0.16970122529060879812 -0.36333993929580893356 0.12621547679919845053 -0.24432657459286610813 0.53279716900166607108 0.19623293690950960322 -0.2142788212311535212 0.058779488678676265756 0.043301918575719154647 -0.33540137624724047916 -0.46789070787196268553 0.26138582687062972276 0.45581641158197871988 -0.3685289650858956656 0.22841584865397585036 0.48602053740152817429 0.57521973106581281154 -0.42126822585732665027];

% Layer 3
b3 = [1.8784597511019973659;-1.7148566370340918574;1.5063438524803398622;-1.3989360472597849316;-1.2082380750972723238;0.88806253622693098748;0.57231058894969522033;-0.38782726131292427629;-0.16133954580682924318;-0.019959391832005235479;-0.055049822357448298382;-0.08701991401337316745;0.57187262490188617292;-0.62298680966512565149;1.1766155632440122858;-1.1167227953880662916;1.2794200005569165146;1.6082521490273724574;-1.7563965663392724359;1.8698873144068262064];
LW3_2 = [-0.08714049015037279855 0.91593630252560431781 0.75439463592408873005 0.034254845611823209195 0.64192730861943503307 -0.49250734128040285498 0.8249484950950690676 0.78043561680639073064 0.22874914360427731075 -0.38330401613429748719;0.38746231033516825848 -1.0144636199382288666 0.62818333960880790023 0.40550875745646230985 -0.12553789853460656234 -0.72565116847666899513 0.76689973011453982377 -0.23083363310102936183 -0.58588394937589649558 -0.034186695276830332546;-0.02429352193741235455 0.67350978602694944186 0.37926097020956284211 -0.84306501367568975613 0.48111357853737429791 0.31736511754361163007 0.58824595113620237186 -0.54093013033987458194 0.68575356290480593557 -0.91487861867513708969;0.10323288067160248105 -0.34267401991885959589 -0.55738255259067626124 0.76618764012750983916 0.40998065331514060849 0.56556851360726789757 -0.76562182338220796662 -0.7416043821818184556 1.780963241909823358 -0.33630352327730328454;-0.030589446904840108393 -0.21251823629046640018 0.061799984423297579794 -0.56519766304286800374 -0.35869881653423318912 1.2146179463697925893 -0.92321435443831501022 -0.57094628202299668729 0.015023534637783822129 0.11622320796589941105;-0.85252286491774020849 0.67617890559706406162 -0.51134094694002762971 0.062825058202193501122 -0.56522613873529936601 0.65854344385023599884 -0.51689046569626551086 -0.62254438027015079893 -0.37066776810201762515 0.78212754234256653962;-0.61524991540598250594 0.86718451325858991741 -0.21126834085345350123 -0.82472286742344469435 -1.0069444570422414476 -0.45132261742726342835 0.31295495466309736221 -0.089862446456776004511 0.56927233802493804049 0.54294109387876066108;0.52982965162603679055 0.80075022562131037418 -0.59107878180272377389 -0.39948794524152203556 0.48674562080277972154 0.45144223914057157732 -0.76431663930938831264 -0.46828661321246761728 -0.41767380295780925925 -0.74823407023681276495;0.7425854176403179352 -0.64696845987936968392 -0.28361168692184579587 -0.52558231347737538464 -0.65667795220685654112 -0.72544725659922515426 0.24290887402456826094 0.013380795992047958554 0.88202426990080506908 0.54586714303812400306;0.86568681687990922669 0.72553165887113479915 -0.16599611612040762743 0.50546147753788372992 -0.24523240342657215418 -0.64215023218139288819 0.36440069569710115127 0.79354522688483508652 -0.9480610192694844951 -0.38509096276876153553;-1.0129142107415625151 -0.4376524557670600224 -0.16658825310151609278 -0.57250756446720041382 -1.0053918324978663446 0.015664802495687205064 -0.18726821251986683348 -1.0892715262008358934 -0.41650692330414951225 -0.67741761892239049647;-0.12032231621634292829 0.31354638858582617456 0.17233720361590706971 -0.011030802655912601284 -0.7691963842367353088 0.01542406476926613812 0.91677312124890641964 -0.82905240871135132963 0.32672327673021595018 -1.0835753881344984961;0.82079712879352273447 0.64303293811279660375 0.00782026766218599928 -0.39506993335596624073 0.56760698131142595102 0.48781416591140885908 -0.38430238046681697295 0.66208560552458139981 -0.1012519830366015311 -1.0889517323880804067;-0.55780156966696026188 -0.47125360263969395813 0.71399166684572668018 0.52696146478421912462 0.5369433195664609082 0.5359611649884139517 0.57759957265239847413 -0.78463052309326186684 -0.22353515873829307714 -0.73832663829188049931;0.49583329671220122137 -0.49579780844410370477 -0.75672281953360454043 -0.026599145640535705459 0.38879145030257700189 0.36544996750289565624 -1.0880476308006092889 -0.027184083177338683179 0.91695013201906783173 -0.00064864328359260856049;-0.39271161809383736685 -0.25726824602146836085 -0.39006309107967535033 -0.82770934406120844073 0.85501801632503104944 0.66715372478257051192 0.065653677443341995623 0.64763263245827484837 -0.22049492916486834737 -0.9253906454994835773;0.85990822416426315744 -0.67524515839905296932 0.64017145138886177858 -0.024126828833895913595 0.17096079049762588631 -0.6363428385290796907 -0.052299492955491778956 1.1289389457242391401 0.0067413710275782837492 0.45645552421689206124;0.83133160865448629817 -0.34500816092722197403 0.042126418236417294272 0.69391250696497264183 -0.33002895909440155275 -0.43138187333583177807 -0.78607824512119195415 0.20062368076921791027 -0.54724437294558214706 -0.89878011596265861005;-0.84240596260784672555 0.10994014473141626442 -1.0273260761708900013 0.5318321584754187592 0.1938074453382002682 -0.26201428861225289912 0.30908733151679196327 -0.69366985404650216562 -0.84982210505543531731 -0.11967570095569228517;0.59801884724640630431 0.86250590206524935244 -0.66344524857801678852 -0.7785254946710448154 -0.4581231473000744181 -0.52373585892510143847 0.65665021776419818522 0.088355621591607327869 -0.41826220161544380716 0.79841333152321636302];

% Layer 4
b4 = [-0.37595605205406867899;0.66069382717782942915;-0.036718821197979804871];
LW4_3 = [-0.48934744423900655708 -0.52866687482291530031 -0.73774443939615219623 1.0309419161658590625 -0.38828709302999259156 -0.65141283956888906825 -0.41238624340719054473 0.66314180862782989845 0.9047605977631908436 0.35724428024938625903 -1.0347241313712287614 0.5065418956597627087 0.31081881787773352199 -0.74065370752415649047 1.2823383677574924366 -0.34738697435602167163 -0.5141104396514908359 0.66294332600715577541 -0.12585018609794540456 0.059136211720753277532;-0.70971449383103912822 -0.19202762421647071034 -0.21958352282798618282 -1.1500977778975112198 -0.68072346095892122264 -0.60984796747134550898 -0.29490647748277210027 0.43230687695167335782 -0.89874413679980291736 -0.10526787913255095108 0.94167644600122690779 -0.68073445280395439294 0.42645685449511772092 -0.75089015109681001015 -0.69025795318432636716 -0.0037614919793567905965 0.29525736318739764785 0.62537255045281692212 0.63980296705311412442 -0.19034380298996017578;0.097309556123200635636 0.19703977714733419968 0.58516265180546778168 -0.59731478123035841588 0.18181883145257754508 0.20744278983774136482 0.74468874214890701246 0.79669897136001077698 0.35354755857180553136 0.39908745837904768816 0.45698549084276907095 -0.091693503567795583975 0.16295543143000137953 -0.42692576016638428271 -0.33246271175571162626 0.56415158668749842974 -0.67197467337493699269 0.46700330518076305086 -0.68655606135750724128 0.62687135312587349834];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [1;1.54272048717391;3.75149113640116];
y1_step1.xoffset = [-1;-0.651338386151203;-0.27428708273995];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
