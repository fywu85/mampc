function [Y,Xf,Af] = nnmove_03(X,~,~)
%NNMOVE_03 neural network simulation function.
%
% Auto-generated by MATLAB, 29-Jun-2022 02:43:59.
% 
% [Y] = nnmove_03(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 3xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.550560990664137;-5.3685645928187;-1.02679412959305;-18.7609202310142;-0.943782740203422;-20.9469586519853];
x1_step1.gain = [1.67440647309341;0.188040627032075;0.955260992906411;0.049691820089723;1.10874678030579;0.0509611124656944];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.2307414786139867502;-2.3606233290491105414;-1.9801658928455907471;1.8037681868266643992;-1.7866567432823743378;-1.3786249926504969832;-0.46466664375317678903;0.058483326862525525369;0.50129383282814921063;-0.27790304965290046901;-0.043348401689912031964;-0.37119542689208756547;0.40486663510972337177;-0.4905279682210344494;1.4259559762614497647;-1.6215971523670127397;1.5503993110575902126;-2.0972079259090561365;2.0078883604501336357;2.5716406697455451713];
IW1_1 = [1.2346305847167493575 1.1644674925921503217 -1.039284771517005046 1.0612815916503433034 -0.24380821090607643353 -0.21545817435498526571;1.1837913648969424774 -1.3350601701936117838 0.60787373957821821957 -0.50692179901552358867 -0.56172095675083422162 -0.39123222007935137823;0.36733443539337878869 1.8607273635937497946 -0.0032337966496076946121 0.037378713632226320818 -0.4107081462527505944 1.0740875800962457198;-0.93970550217015558214 0.71401971523181884116 -0.98758273568349908 -0.83722072985845097381 -0.74917853757596453157 0.89966613937709405402;0.52656862951246830029 0.98403410769147958703 -1.0678320399601759494 -0.38012507737666240137 0.016820104724433938836 1.2588533617338553139;0.89421597870782776329 0.30258731620720241695 0.60274272755840330174 1.0058801571093165528 1.164460646268524302 -1.0910545898506449625;0.018585745586380517796 1.0775747344030548458 -0.7360491536885328534 -1.4545045785387944459 0.12088482891915332262 -0.11106035261969010586;-0.84205499537780537089 0.041663563178296232625 0.70218166570341578048 -0.7024924229853946045 -1.2739601063152863336 -0.263597877823702198;-0.34428833075713732859 0.87834599553891867796 -1.1580798193664245677 1.2427384503008238603 -0.11084270520332113741 -0.64830077492626125846;1.1096050074548950981 0.94305747164088971068 0.82707209509060974906 0.019220917025257161503 0.60538604259317674305 0.90515737140960039753;-0.37176980690861838319 -1.0985925304686896542 0.60524455992090542278 0.012868940798314658022 -0.98306072740611427641 0.87345772298792889732;-0.63842841659350069161 0.26193904678492596627 -0.48929374848306750323 1.2183621103434627564 0.49757781597593475631 0.4935261741161695026;-0.2362371103986574683 -0.28706875306895363043 0.84470483158114983979 -0.22293718809335386077 0.35675190309238513642 1.3027419414061154335;-0.55398534623480866212 -0.57849037615731357942 0.52952210823535073025 2.0511778660808657193 0.028841576209263558583 0.42139524361208713366;0.5457363391889678006 -0.10995651770328726538 0.88166527540660810658 -1.2739382604754283523 -0.38215004916674805147 1.1751775268796764706;-1.1294890913487762862 0.30415565890698592622 -0.61375694791097878955 1.3048886829845702806 0.048701589760180095945 -0.55050945865805356316;1.4856228599290808301 -0.34211001162034071488 0.73116092547087352393 0.92432564890612134434 -0.87427944962917536476 -0.56652775922616838145;-1.1353920190892585751 0.89103138894621480848 0.0050598888450309881248 -0.5672915948670953501 0.81251865051771576809 1.1454426452630395161;1.2789023134668948689 -0.82932469307578837725 0.79275537564800790946 -1.1640099757767572441 -0.81742570678248049898 0.020740946512133845436;0.8971291359836576218 1.1834132627503821666 0.61420024185997035282 -1.0612376785362827025 -0.69233370390736226341 0.072043541912884215273];

% Layer 2
b2 = [1.5528509142238851037;1.3792266268868029755;-0.76698473341418282878;-0.51378934053523972469;0.33185393175492405859;0.26315679582577250484;-0.57963220839349194335;-0.96555746414540655209;1.3909607572390372265;-1.5313348104743280675];
LW2_1 = [0.013068931365405489498 -0.084903670088233795799 -0.13222225834916723208 -0.025812139154526608092 0.041085342088302820307 -0.60300107957055104624 0.081218065488402088614 -0.077321582143219852457 -0.08355246176296891869 -0.11786866625768918637 -0.31558264184337891933 0.73112544274876833938 0.18527855706724882801 0.83666246265917465497 0.46103699703629363871 -0.088364612659920613313 -0.64090581815234282104 0.06748178177106732567 -0.080193297405669300426 0.036306102601095374682;-0.27441271192502086906 -0.032977320026554388099 -0.35100656982361200242 0.20900204444728420761 0.091008987558550247243 0.35729935050410788211 0.4296898062387006223 0.16806746153473936523 0.29756851647280346818 -0.55477189030458762264 0.020125959799058609767 -0.11125247112998733201 0.37586149685462622028 -0.27401293874313548127 -0.13484587233324255018 -0.57421252729323457586 0.63404725964674468752 0.26882028495914134236 -0.21858229948558724476 0.73783425795233648081;0.2319305466252775394 -0.15154304947185887054 -0.1280522948789166171 0.17589643549155278834 0.188414417470691542 -0.27957369596472231299 -0.23733369990437500063 0.040342405477038351114 -0.23419950455502516751 0.13150283824801439758 -0.077015506414864057239 0.44045723118601431967 0.15615445487010456982 0.54062729975387779913 0.074045371741089272 -0.18882651333336405997 -0.07689565131746622928 -0.12552822929847054501 -0.10337282467141996334 -0.12285865811015052318;0.49787630567581286911 0.11714126245753482547 0.44143044546331089428 -0.09424173240039879218 -0.070844114947218955747 0.12110154631531086511 0.76743821524632849229 -0.27785828141744411957 -0.48026867403474832185 -0.22673843518433708932 0.21733767642959564426 -0.62210123459436272864 0.37444908544970229025 0.3443302583945084816 0.44524727200358954482 -0.020884684881906982051 -0.066457950007528021619 0.037137316979506659886 -0.23687294149176610358 0.1345675385599299223;0.06219231970273596255 -0.5130814321533320177 -0.0090763384069642051577 0.1228154175916787022 -0.27916290428641526988 -0.17368793309475191733 -0.062497818884927586192 0.21937208069246014186 0.20557844144350362336 0.075382047862631917923 0.19373019933315577257 -0.2220955951221565694 -0.087209657131742751579 0.34072481654401925999 0.17013329808804167342 -0.35070371207580769424 -0.34142393334720905207 0.45271659360943733441 -0.061428864407478508958 -0.25657760134446810918;0.090657791829164030561 -0.040739453635941245968 0.29287889638312403218 0.40876987680579535134 0.26138143502469951551 -0.51914649948135105362 0.21575977584006517107 0.12340195259272204731 -0.23542215554997372728 0.039154825973389220661 -0.25331288419823261293 0.13803324506328254473 -0.29736923504940926399 -0.23717780888511830195 0.35760991960257809685 0.47662319720617668528 -0.16117865616706969489 -0.65105505738224278556 0.081649233646496344186 -0.12070910286189942551;-0.35950719637675537799 0.60025457769217815951 0.32382259037871236051 0.083479537960748390057 -0.29285668592592178916 0.40206874022277372394 -0.34163511281576575129 -0.21306101879912997532 0.16229575858800149302 -0.39505193907934099684 0.15537528059329575036 0.30329597906237310001 -0.43002730902813429692 0.093939892873930147532 0.028406168368890361703 0.13771732295504238164 0.028892791081913546392 -0.016726874408432894359 -0.16919617266629424779 -0.18543079517958779845;-0.28843902399146881255 0.1530422608786548011 0.034976669484283150202 -0.10055421542139418578 0.24169313503042819113 0.18766381011521196531 -0.39053052132323989865 -0.11974733235314588553 -0.3117976754141557616 -0.27653153704591254547 0.12540512229190012294 0.072357966405390605757 0.25745406932840309011 -0.13600644092189784207 0.28046150777899470086 0.7598131611897307458 -0.03609469924444987099 -0.45557218961544515556 0.091977155626323053861 -0.036392061987252026511;0.36876576512536862751 0.2051722958461965618 0.13475302297622238079 -0.18130722260671416901 -0.043071810538494903486 0.15958532343101830553 -0.42266933316442034663 -0.0032043518158620890729 0.00429837381297310233 -0.13432373476223111175 -0.1116809421295216348 -0.057601938283658532525 0.537476400379598096 0.5530265062680624899 -0.39229188252628954814 0.63740757798457969852 0.090437592680921510824 -0.033411845251576990923 0.40331768177388682695 0.49741318442943399658;-0.10408946400446655867 0.52179386293342255865 0.013908364633508078778 0.55588114947326838777 0.52644663058949703327 -0.02569451603568475434 0.1113541437573445092 -0.10821842702275737136 0.23344575163862249512 0.24406959990722534859 -0.1717958183367132019 0.061846513228881128121 0.068048599045709257105 -0.60082115046126216562 0.0074044940907232112415 0.63848155541186002448 0.33682701143156584811 -0.013245069249698438948 -0.54617854362429529846 -0.24335652984873376581];

% Layer 3
b3 = [1.7579098186445067942;1.76850718234278248;-1.3465555759392724422;-1.4731331676587924306;1.102763162083511439;-0.93284645753662032153;0.52268182178861688492;-0.46500165878799343266;-0.20404678157737093924;0.065826228902619257632;0.05227709849656916874;-0.39070052031291441219;-0.46210939693361219316;0.87522562396542702423;1.0437056540552593908;-1.1823108838506055651;1.2717014645816500096;-1.497289915195276544;-1.6848551588795364076;1.9319104183420787724];
LW3_2 = [-0.82650583274291589131 0.30061758858325310362 -0.075967429745433093236 0.7851317452972051969 0.090353475914966424609 -0.59963089038705852385 -0.71518311334446360572 -0.43810509512144557576 -0.54376250448609109167 1.0415663835540316384;-0.24905357880505968327 0.11359413191226090667 0.38549249776340355211 0.77401077697682185708 0.36629764820845206463 0.64323686469408047905 0.3790238471929388564 0.71616992591658079625 0.50781650499724662051 -0.98582551171100762932;0.8166391901568238465 0.91333997701231528499 -0.23048903414640112275 -0.030554324981981337284 -0.39108187584466119757 -0.14202458132058745632 -0.7682509468339262515 -0.089239177365256064367 0.99551981702787573081 -0.89964321943626324174;0.7859021484045425332 -0.84552040322780730452 -0.65835592113250007706 -0.43394781641273882933 -0.15925478274392543265 0.48779752993117297954 0.3703155420616844884 0.77696775704279197328 -0.62137574217438784618 0.14578763667838939844;-0.69163636873464673371 0.2907169902181295229 -0.98559522957235556895 0.078783338943131886456 0.74349578849017228244 0.25103162995666711277 0.25850261249607275893 -0.68057105168577636256 0.22897911077624105713 -0.93512134764426202427;1.1473614569024939147 0.6152261781452398326 0.4636613242234447485 0.99906351534658754954 0.14825326141362690779 0.25612169551110558485 0.0076550614072509667873 -0.64403272963511426497 0.046330740888743351946 0.28870331316225655849;-0.91139491965611807434 -0.66614489386417696792 -0.57536995051478745378 -0.088851341705296016382 -0.81621357122341120505 0.69942396563073505611 -0.31183566223594810785 0.14402368967332190852 -0.45729426592193517243 0.29164104641250859773;0.48051618512273758244 0.2392198546684798921 -0.90315081651392281614 0.93144289645978373127 0.26788708146191120285 0.73033820603811649974 -0.35383486390791990539 0.30511470272448970587 -0.55477839662412786748 0.81005074087322936904;0.096464090747459083075 -0.12467950591315415942 -0.97033926758348143515 -0.77341407426228503397 -0.15772661234660648177 0.23130843636791084683 -1.192511931463875019 0.0070835155117486767185 0.63055112790408607282 -0.65739704746755078801;-0.62444388589732702233 -0.92187866122359685139 -0.60035191484148675567 -0.60055966121384207757 -0.22074697670352352863 0.29141919436481505956 0.91262393205409952923 -0.0089298737628185249904 -0.68668215927605191773 0.47810146044514689745;0.75488562546770987538 0.58041059197158628713 0.68217672241295101987 -0.71718575384319305233 0.78951734101111370467 0.27644210758896875513 -0.0040956957517350178755 -0.316498578298231803 0.61690134498631110649 0.5414443730835207802;-0.56067327146180501174 -0.96259157949599727377 0.37942949325332481214 -0.55121507421837301344 -0.70663645999598123648 -0.07580286231152896792 0.6829797695678675451 0.90445917062343639259 0.42155792501596889288 -0.24543585369058837364;-0.66894585648270388223 -0.94487267108012218397 -0.91310782283963543016 -0.39629159438680228167 0.5043340448889815919 -0.011868505799331312625 0.510481344405164017 -0.59634505851809460619 0.13583719448533682073 -0.91070599419019249154;0.28768157431250473977 0.18631919499980534316 -0.79425346792610729274 0.11001351180225955873 -0.59181156161475456656 0.33067640441275902852 0.61482852304685864375 -0.94706220540887575687 0.882452135953228467 -0.66697508143900230415;0.42582221870693387489 0.94354891344954039401 -0.87028375033030924701 -0.64747177573984759924 -0.55645078024050631527 0.76255686947591050373 0.48498589131649777473 0.38750546221072001973 -0.026600099797540514845 -0.091445564444817550864;0.090170322171088196361 0.2920910167247775524 -0.11921116267029266411 -0.44843053998179094322 -0.91367327775510354115 0.87003714759098227383 -0.53874798159899606187 -0.091282381405233453675 0.51632236931686292802 -0.3235853880887695766;0.38830969940115322991 0.7043372049151518377 -0.20425414920159976062 0.25290044647914844411 0.065932161618339812925 -1.0593680409025472144 -0.55115453915484524661 0.80600679209969028349 -0.75805132700874788831 -0.59301833330319031479;-0.24378928732625290698 -0.64773771778094768603 -0.51824088575113846922 -0.96543439231527683475 0.75784467910127839563 -0.068801412067627160107 0.72797622554398688788 0.35287313160974886905 -0.81219559813182262697 0.0082419112256915377096;-0.60354411378956385192 0.16212336105305891198 -0.38863902241423931017 -0.89304673471994477918 -0.84261892793955173175 0.79690325215145629834 -0.0075870483635616606938 0.72439950015867138333 -0.094474313441579305106 -0.43003341323406707453;-0.010999691054464485682 -0.40434717872621156465 -0.45226842933311633965 -0.13718185274269908969 0.040872330540275052246 0.07259058603275890531 0.6850998976144464514 -0.90606943159268771293 -1.1239141529152201215 0.40316542700981028435];

% Layer 4
b4 = [-0.32985454714313988678;0.2335245466331141162;0.83963714588079740864];
LW4_3 = [-0.80496228997053731469 0.091892633688409691706 -0.014526854996913123735 0.45863267490761439049 0.67224187991268802289 -0.022802832069296081335 -0.60008617499658067906 -0.5037547076693409398 0.68723272278238212163 -0.081447987566376001123 -0.6309307814284161875 -0.62839661899674548184 -0.4221336220441633813 -0.52542833685569123592 -0.077149630313266298609 -0.99919295483789238865 0.8167238315783856839 0.56147524994678599253 0.04190849031700149413 -0.27299139934341226654;-0.020734661204909778098 0.086823969409198342717 -0.62990580261580164656 -0.77595609606753879195 -0.59431616519960606126 -0.3705128088549322074 0.65140879194733591895 0.7370397025055757112 -0.45772924025698369377 -0.24109279915202422306 -0.72507255795044445179 -1.0574131610876496001 0.14760235795729095831 -0.72441950647207653535 0.060963409506946363015 0.33437593014024674654 0.48893583637881210535 -0.12522449728432150096 -0.034983081543639264754 0.78437181369661590491;0.030755214833985484307 -0.20586999882886886093 0.80290957395081175019 -0.025956278675300523129 -0.37039178311945103461 -0.12287754481533434692 0.56043486889828741937 0.88419921506580834158 0.28886658345741550447 0.029358573859825872615 0.66935934719946488247 -0.78938880691660395783 1.1300788199713585058 -0.79526527565395399577 -0.67104708957612602127 0.23285231450076826487 -0.50009042256355773493 -0.52570942416199051284 0.70127138936464361585 -0.51567343500948370494];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [1;1.54004814031226;3.72914017826877];
y1_step1.xoffset = [-1;-0.636263333787975;-0.261921565936486];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
